# Tracking
Computer vision object tracking learning notes
# 深度学习的目标跟踪算法综述
## 简单认识目标跟踪

  目标跟踪是利用一个视频或图像序列的上下文信息，对目标的外观和运动信息进行建模，从而对目标运动状态进行预测并标定目标位置的一种技术。  
  目标跟踪是计算机视觉的一个重要分支其利用视频或图像序列的上下文信息#对目标的外观和运动信息进行建模从而对目标运动状态进行预测并标定目标的位置。目标跟踪融合了图像处理、机器学习、最优化等多个领域的理论和算法，是完成更高层级的图像理解如目标行为识别任务的前提和基础。  
## 视觉跟踪的基本框架
  视觉跟踪系统的基本框架一般由搜索策略、特征提取和观测模型等模块组成，目前常用的搜索策略包括均值漂移，粒子滤波和循环密集采样等几种方式。
### 搜索策略
  通过搜索策略获得候选样本后进行特征提取主要包括人工特征和学习特征最后利用特征判断候选样本是否为跟踪目标的观测模型通常分为生成式模型和判别式模型。
### 基于生成式模型的方法
  生成式模型提取目标特征构建表观模型，在图像中搜索与模型最匹配的区域作为跟踪结果
#### LK光流法
它假定目标灰度在短时间内保持不变，同时目标邻域内的速度向量场变化缓慢通。过匹配角点实现对目标的跟踪。随后工作则考虑采用原始的外观或者颜色作为主要特征来描述目标，或者采用更为复杂的混合方式描述目标，这种方法包含三部分分别描述目标的稳定特征、瞬变特征和噪声过程然而上述特征很难描述目标的变化，如当目标角度突然发生剧烈变化时该外观模型就会失效，甚至丢失目标导致跟踪任务失败。
##### 多角度模型
多角度模型被用来描述目标，它通过计算当前含有目标的图像和用特征向量重建的图像之间的仿射变换差异来跟踪目标。在此基础上等人在线更新特征空间的基，直接将以前检测到的目标作为样本在线学习而无需大量的标注样本。
#### L1跟踪器
把跟踪看做一个稀疏近似问题，通过求解L1范数最小化问题，实现对目标的跟踪。
#### SIFT,SURF和最大稳定极值区域
这三个等更为鲁棒的局部特征也用来描述目标，以适应目标在局部的各种尺度和旋转的变化。
### 基于生成式模型的方法的不足
生成式模型不论采用全局特征还是局部特征，其本质是在目标表示的高维空间中，找到与目标模型最相邻的候选目标作为当前估计。但是，此类方法的缺陷在于只关注目标信息，而忽略了背景信息。
### 基于判别式模型的方法
与生成式模型不同的是，判别式模型同时考虑了目标和背景信息。判别式模型将跟踪问题看做分类或者回归问题，目的是寻找一个判别函数，将目标从背景中分离出来，从而实现对目标的跟踪。
#### 分类判别式模型
早期，Collins等人利用线性判别分析自适应地选择对当前背景和目标最具区分力的颜色特征,从而分离出目标.随后，各种分类器被引入至目标跟踪领域。Avidan采用支持向量机和等机器学习方法区分背景和目标，但由于所选取的特征基于单个像素，所以容易丢失目标。Crabner等人结合Haar特征等和在线Boosting算法对目标进行跟踪。TLD利用在线的Ferns检测目标，同时利用在线随机森林算法跟踪目标。Hare等人提出Struck算法，，利用结构化的支持向量机直接输出跟踪结果，避免中间分类环节，取得了优异的性能。
#### 回归判别式模型
基于回归判别模型的典型方法是相关滤波，其利用循环矩阵#通过快速傅里叶变换实现时域到频域的转换，大大提升了算法的速度。 相关滤波因速度优势受到了广泛关注，逐渐成为目标跟踪领域的主流框架。
Henriques等人在MOSSE算法的基础上，提出CSK算法，也称为核相关滤波算法，其采用循环移位进行密集采样，并通过核函数将低维线性空间映射到高维空间，提高了相关滤波器的鲁棒性。随后的工作主要从特征选择、尺度估计、正则化等方面对该算法进行改进和提高。
###### 降噪自动编码器
Denoising Autoencoder（降噪自动编码器）就是在Autoencoder的基础之上，为了防止过拟合问题而对输入的数据（网络的输入层）加入噪音，使学习得到的编码器W具有较强的鲁棒性，从而增强模型的泛化能力。Denoising Auto-encoder是Bengio在08年提出的，具体内容可参考其论文：Extracting and composing robust features with denoising autoencoders.
论文中关于Denoising Auto-encoder的示意图如下，其中x是原始的输入数据，Denoising Auto-encoder以一定概率把输入层节点的值置为0，从而得到含有噪音的模型输入xˆ。这和dropout很类似，不同的是dropout是隐含层中的神经元置为0。
###### 图像噪声
图像噪声是指存在于图像数据中的不必要的或多余的干扰信息。噪声的存在严重影响了遥感图像的质量，因此在图像增强处理和分类处理之前，必须予以纠正。   图像中各种妨碍人们对其信息接受的因素即可称为图像噪声 。噪声在理论上可以定义为“不可预测，只能用概率统计方法来认识的随机误差”。因此将图像噪声看成是多维随机过程是合适的，因而描述噪声的方法完全可以借用随机过程的描述，即用其概率分布函数和概率密度分布函数。
###### 图像灰度
灰度图像上每个像素的颜色值又称为灰度，指黑白图像中点的颜色深度，范围一般从0到255，白色为255，黑色为0。所谓灰度值是指色彩的浓淡程度，灰度直方图是指一幅数字图像中，对应每一个灰度值统计出具有该灰度值的象素数。

　　灰度就是没有色彩，RGB色彩分量全部相等。如果是一个二值灰度图象，它的象素值只能为0或1，我们说它的灰度级为2。用个例子来说明吧：一个256级灰度的图象，如果RGB三个量相同时，如：RGB(100,100,100)就代表灰度为100，RGB(50,50,50)代表灰度为50。

　　现在大部分的彩色图像都是采用RGB颜色模式，处理图像的时候，要分别对RGB三种分量进行处理，实际上RGB并不能反映图像的形态特征，只是从光学的原理上进行颜色的调配。

　　图像灰度化处理可以作为图像处理的预处理步骤，为之后的图像分割、图像识别和图像分析等上层操作做准备。
###### 互相关运算在目标跟踪
互相关运算可以用来度量两个信号之间的相似性。  
互相关运算让我们得以衡量 h与f的相似度，换句话说，互相关得到的响应图中每个像素的响应高低代表着每个位置相似度的高低。假设目标存在于新一帧图像f中的话，那么在h和f对得最齐的地方就应该是目标中心的位置了！
![img1](https://github.com/ChenJian-Jia/Tracking/blob/main/%E4%BA%92%E7%9B%B8%E5%85%B3%E5%AE%9A%E4%B9%89.png)
#### DLT
![img](https://github.com/ChenJian-Jia/Tracking/blob/main/DLT.png)  
DLT是第一个把深度模型运用在单目标跟踪任务上的跟踪算法。它的主体思路如上图所示：
(1) 先使用栈式降噪自编码器(stacked denoising autoencoder，SDAE)在Tiny Images dataset这样的大规模自然图像数据集上进行无监督的离线预训练来获得通用的物体表征能力。预训练的网络结构如上图(b)所示，一共堆叠了4个降噪自编码器, 降噪自编码器对输入加入噪声，通过重构出无噪声的原图来获得更鲁棒的特征表达能力。SDAE1024-2560-1024-512-256这样的瓶颈式结构设计也使获得的特征更加compact。
(2) 之后的在线跟踪部分结构如上图(c)所示，取离线SDAE的encoding部分叠加sigmoid分类层组成了分类网络。此时的网络并没有获取对当前被跟踪物体的特定表达能力。此时利用第一帧获取正负样本，对分类网络进行fine-tune获得对当前跟踪目标和背景更有针对性的分类网络。在跟踪过程中，对当前帧采用粒子滤波(particle filter)的方式提取一批候选的patch(相当于detection中的proposal)，这些patch输入分类网络中，置信度最高的成为最终的预测目标。
(3) 在目标跟踪非常重要的模型更新策略上，该论文采取限定阈值的方式，即当所有粒子中最高的confidence低于阈值时，认为目标已经发生了比较大的表观变化，当前的分类网络已经无法适应，需要进行更新。

小结：DLT作为第一个将深度网络运用于单目标跟踪的跟踪算法，首先提出了“离线预训练＋在线微调”的思路，很大程度的解决了跟踪中训练样本不足的问题。

#### DLT的不足：
(1) 离线预训练采用的数据集Tiny Images dataset只包含32*32大小的图片，分辨率明显低于主要的跟踪序列，因此SDAE很难学到足够强的特征表示。
(2) 离线阶段的训练目标为图片重构，这与在线跟踪需要区分目标和背景的目标相差甚大。
(3) SDAE全连接的网络结构使其对目标的特征刻画能力不够优秀，虽然使用了4层的深度模型，但效果仍低于一些使用人工特征的传统跟踪方法如Struck等。
